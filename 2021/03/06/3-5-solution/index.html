<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"example.com",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.json"}</script><meta name="description" content="A："><meta property="og:type" content="article"><meta property="og:title" content="3&#x2F;5练习赛题解"><meta property="og:url" content="http://example.com/2021/03/06/3-5-solution/index.html"><meta property="og:site_name" content="zqs&#96;s blog"><meta property="og:description" content="A："><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2021-03-06T12:30:32.000Z"><meta property="article:modified_time" content="2021-03-07T02:17:21.439Z"><meta property="article:author" content="zqs菜鸡"><meta property="article:tag" content="比赛"><meta name="twitter:card" content="summary"><link rel="canonical" href="http://example.com/2021/03/06/3-5-solution/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>3/5练习赛题解 | zqs`s blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div> <a target="_blank" rel="noopener" href="https://github.com/ioiakzqs" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#70b7fd;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">zqs`s blog</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">有朋自远方来，虽远必诛</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2021/03/06/3-5-solution/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="zqs菜鸡"><meta itemprop="description" content="反正是个菜鸡"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="zqs`s blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 3/5练习赛题解</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-03-06 20:30:32" itemprop="dateCreated datePublished" datetime="2021-03-06T20:30:32+08:00">2021-03-06</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-03-07 10:17:21" itemprop="dateModified" datetime="2021-03-07T10:17:21+08:00">2021-03-07</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%AF%94%E8%B5%9B/" itemprop="url" rel="index"><span itemprop="name">比赛</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span> <span class="post-meta-item-text">Valine：</span><a title="valine" href="/2021/03/06/3-5-solution/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2021/03/06/3-5-solution/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="A："><a href="#A：" class="headerlink" title="A："></a>A：</h1><span id="more"></span><p><del>看起来很签到,写起来很恶心</del></p><p><del>不过貌似我写的代码是全场最长</del></p><p>类似最大连续和，线段树维护一下最大前缀，最大后缀，最大子段。我的代码里面需要维护一下最大前缀开头的数字是多少，最大后缀开头的数字是多少（所以就有了<code>sub0,sub1,suf0,suf1</code>）。</p><p>然后就是码农了。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">wrnm，这题出题人没有horse实锤了 </span></span><br><span class="line"><span class="comment">等等，就我一个人写了这么长吗，wtcl </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> x, <span class="keyword">const</span> <span class="keyword">int</span> y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> l, r, v, sub0, sub1, suf0, suf1;</span><br><span class="line">&#125; c[<span class="number">1000005</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">200005</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">make_tree</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O, <span class="keyword">const</span> <span class="keyword">int</span> L, <span class="keyword">const</span> <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">	c[O].l = L, c[O].r = R, c[O].v = c[O].sub0 = c[O].suf0 = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (L != R) &#123;</span><br><span class="line">		<span class="built_in">make_tree</span>(O &lt;&lt; <span class="number">1</span>, L, L + R &gt;&gt; <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">make_tree</span>(O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, (L + R &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>, R);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O)</span> </span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> ls c[O &lt;&lt; 1]</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> rs c[O &lt;&lt; 1 | 1]</span></span><br><span class="line">	const int llen(ls.r - ls.l + 1), rlen(rs.r - rs.l + 1);</span><br><span class="line">	c[O].sub0 = c[O].sub1 = c[O].suf0 = c[O].suf1 = c[O].v = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (ls.suf0 == llen) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!a[ls.l]) c[O].sub0 = <span class="built_in">max</span>(c[O].sub0, llen + rs.sub1);</span><br><span class="line">		<span class="keyword">else</span> c[O].sub1 = <span class="built_in">max</span>(c[O].sub1, llen + rs.sub1);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (ls.suf1 == llen) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!a[ls.l]) c[O].sub0 = <span class="built_in">max</span>(c[O].sub0, llen + rs.sub0);</span><br><span class="line">		<span class="keyword">else</span> c[O].sub1 = <span class="built_in">max</span>(c[O].sub1, llen + rs.sub0);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (rs.sub0 == rlen) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!a[rs.r]) c[O].suf0 = <span class="built_in">max</span>(c[O].suf0, rlen + ls.suf1);</span><br><span class="line">		<span class="keyword">else</span> c[O].suf1 = <span class="built_in">max</span>(c[O].suf1, rlen + ls.suf1);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (rs.sub1 == rlen) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!a[rs.r]) c[O].suf0 = <span class="built_in">max</span>(c[O].suf0, rlen + ls.suf0);</span><br><span class="line">		<span class="keyword">else</span> c[O].suf1 = <span class="built_in">max</span>(c[O].suf1, rlen + ls.suf0);</span><br><span class="line">	&#125;</span><br><span class="line">	c[O].sub0 = <span class="built_in">max</span>(c[O].sub0, ls.sub0);</span><br><span class="line">	c[O].sub1 = <span class="built_in">max</span>(c[O].sub1, ls.sub1);</span><br><span class="line">	c[O].suf0 = <span class="built_in">max</span>(c[O].suf0, rs.suf0);</span><br><span class="line">	c[O].suf1 = <span class="built_in">max</span>(c[O].suf1, rs.suf1);</span><br><span class="line">	c[O].v = <span class="built_in">max</span>(<span class="built_in">max</span>(ls.v, rs.v), <span class="built_in">max</span>(ls.suf0 + rs.sub1, ls.suf1 + rs.sub0));</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">undef</span> ls</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O, <span class="keyword">const</span> <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (c[O].l == c[O].r) &#123;</span><br><span class="line">		<span class="keyword">if</span> (a[p] == <span class="number">0</span>) c[O].sub1 = c[O].suf1 = a[p] = <span class="number">1</span>, c[O].sub0 = c[O].suf0 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">else</span> c[O].sub0 = c[O].suf0 = <span class="number">1</span>, c[O].sub1 = c[O].suf1 = a[p] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">const</span> <span class="keyword">int</span> <span class="title">mid</span><span class="params">(c[O].l + c[O].r &gt;&gt; <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">if</span> (p &lt;= mid) <span class="built_in">update</span>(O &lt;&lt; <span class="number">1</span>, p);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">update</span>(O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, p);</span><br><span class="line">	<span class="built_in">pushup</span>(O);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n, q;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">	<span class="built_in">make_tree</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">	<span class="keyword">while</span> (q --) &#123;</span><br><span class="line">		<span class="keyword">int</span> x;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">		<span class="built_in">update</span>(<span class="number">1</span>, x);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, c[<span class="number">1</span>].v);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="B"><a href="#B" class="headerlink" title="B:"></a>B:</h1><p>被C题耽误了，没时间想。。。</p><p>不难想到给 $A$ 数组排个序，这样可以线段树上二分出当前第一个 $\ge b$ 的位置 $pos$。将 $[pos,n]$ 这段区间设为 $b$ 即可。然后每一次操作都要整体加一下，因此线段树需要写区间赋值，区间加。因为只求总共割掉了多少，因此直接看根节点的值就行了。注意由于要在线段树上二分，所以为了方便我记了一个最大值。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">const</span> ll x, <span class="keyword">const</span> ll y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">	ll l, r, v, mx, Lazy1, Lazy2;</span><br><span class="line">&#125; c[<span class="number">2000005</span>];</span><br><span class="line">ll a[<span class="number">500005</span>], s[<span class="number">500005</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O)</span> </span>&#123;</span><br><span class="line">	const ll llen(c[O &lt;&lt; 1].r - c[O &lt;&lt; 1].l + 1), rlen(c[O &lt;&lt; 1 | 1].r - c[O &lt;&lt; 1 | 1].l + 1);</span><br><span class="line">	<span class="keyword">if</span> (c[O].Lazy2 != <span class="number">-1</span>) &#123;</span><br><span class="line">		c[O &lt;&lt; <span class="number">1</span>].Lazy2 = c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].Lazy2 = c[O].Lazy2;</span><br><span class="line">		c[O &lt;&lt; <span class="number">1</span>].v = llen * c[O].Lazy2, c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].v = rlen * c[O].Lazy2;</span><br><span class="line">		c[O &lt;&lt; <span class="number">1</span>].mx = c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].mx = c[O].Lazy2;</span><br><span class="line">		c[O &lt;&lt; <span class="number">1</span>].Lazy1 = c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].Lazy1 = <span class="number">0LL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	c[O &lt;&lt; <span class="number">1</span>].v += (s[c[O &lt;&lt; <span class="number">1</span>].r] - s[c[O &lt;&lt; <span class="number">1</span>].l - <span class="number">1</span>]) * c[O].Lazy1;</span><br><span class="line">	c[O &lt;&lt; <span class="number">1</span>].Lazy1 += c[O].Lazy1;</span><br><span class="line">	c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].v += (s[c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].r] - s[c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].l - <span class="number">1</span>]) * c[O].Lazy1;</span><br><span class="line">	c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].Lazy1 += c[O].Lazy1;</span><br><span class="line">	c[O &lt;&lt; <span class="number">1</span>].mx += c[O].Lazy1 * a[c[O &lt;&lt; <span class="number">1</span>].r], c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].mx += c[O].Lazy1 * a[c[O].r];</span><br><span class="line">	c[O].Lazy1 = <span class="number">0LL</span>, c[O].Lazy2 = <span class="number">-1LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O)</span> </span>&#123;</span><br><span class="line">	c[O].v = c[O &lt;&lt; <span class="number">1</span>].v + c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].v;</span><br><span class="line">	c[O].mx = <span class="built_in">max</span>(c[O &lt;&lt; <span class="number">1</span>].mx, c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].mx);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">make_tree</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O, <span class="keyword">const</span> <span class="keyword">int</span> L, <span class="keyword">const</span> <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">	c[O].l = L, c[O].r = R, c[O].Lazy2 = <span class="number">-1LL</span>;</span><br><span class="line">	<span class="keyword">if</span> (L != R) &#123;</span><br><span class="line">		<span class="built_in">make_tree</span>(O &lt;&lt; <span class="number">1</span>, L, L + R &gt;&gt; <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">make_tree</span>(O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, (L + R &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>, R);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Set</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O, <span class="keyword">const</span> <span class="keyword">int</span> L, <span class="keyword">const</span> <span class="keyword">int</span> R, <span class="keyword">const</span> ll d)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L &gt; R) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= c[O].l &amp;&amp; c[O].r &lt;= R) &#123;</span><br><span class="line">		c[O].v = d * (c[O].r - c[O].l + <span class="number">1</span>);</span><br><span class="line">		c[O].Lazy1 = <span class="number">0LL</span>, c[O].Lazy2 = c[O].mx = d;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">const</span> <span class="keyword">int</span> <span class="title">mid</span><span class="params">(c[O].l + c[O].r &gt;&gt; <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="built_in">pushdown</span>(O);</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= mid) <span class="built_in">Set</span>(O &lt;&lt; <span class="number">1</span>, L, R, d);</span><br><span class="line">	<span class="keyword">if</span> (mid &lt; R) <span class="built_in">Set</span>(O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, L, R, d);</span><br><span class="line">	<span class="built_in">pushup</span>(O);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O, <span class="keyword">const</span> <span class="keyword">int</span> L, <span class="keyword">const</span> <span class="keyword">int</span> R, <span class="keyword">const</span> ll d)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= c[O].l &amp;&amp; c[O].r &lt;= R) &#123;</span><br><span class="line">		c[O].v += d * (s[c[O].r] - s[c[O].l - <span class="number">1</span>]);</span><br><span class="line">		c[O].Lazy1 += d, c[O].mx += a[c[O].r] * d;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">const</span> <span class="keyword">int</span> <span class="title">mid</span><span class="params">(c[O].l + c[O].r &gt;&gt; <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="built_in">pushdown</span>(O);</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= mid) <span class="built_in">update</span>(O &lt;&lt; <span class="number">1</span>, L, R, d);</span><br><span class="line">	<span class="keyword">if</span> (mid &lt; R) <span class="built_in">update</span>(O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, L, R, d);</span><br><span class="line">	<span class="built_in">pushup</span>(O);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O, <span class="keyword">const</span> <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (c[O].mx &lt;= x) <span class="keyword">return</span> c[O].r + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (c[O].l == c[O].r) <span class="keyword">return</span> c[O].l;</span><br><span class="line">	<span class="built_in">pushdown</span>(O);</span><br><span class="line">	<span class="keyword">if</span> (c[O &lt;&lt; <span class="number">1</span>].mx &gt; x) <span class="keyword">return</span> <span class="built_in">query</span>(O &lt;&lt; <span class="number">1</span>, x);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">query</span>(O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n, m, <span class="built_in">pred</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> <span class="built_in">i</span>(<span class="number">1</span>); i &lt;= n; ++ i) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, a + i);</span><br><span class="line">	std::<span class="built_in">sort</span>(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> <span class="built_in">i</span>(<span class="number">1</span>); i &lt;= n; ++ i) s[i] = s[i - <span class="number">1</span>] + a[i];</span><br><span class="line">	<span class="built_in">make_tree</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">	<span class="keyword">while</span> (m --) &#123;</span><br><span class="line">		ll d, b;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;d, &amp;b);</span><br><span class="line">		<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, d - pred);</span><br><span class="line">		pred = d;</span><br><span class="line">		<span class="function">ll <span class="title">t</span><span class="params">(c[<span class="number">1</span>].v)</span></span>;</span><br><span class="line">		<span class="built_in">Set</span>(<span class="number">1</span>, <span class="built_in">query</span>(<span class="number">1</span>, b), n, b);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, t - c[<span class="number">1</span>].v);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="C"><a href="#C" class="headerlink" title="C:"></a>C:</h1><p>考场上送我爆零的题。</p><p>考虑暴力。自然就是 $dp_{i,j}$ 表示完成了前 $i$ 个操作，其中位置不在 $x_i$ 上的棋子的位置为 $j$。对于所有的 $dp_{i,j}$，$dp_{i,j}=dp_{i-1,j}+abs(x_i-x_{i-1})$。对于 $dp_{i,x_{i-1}}$，$dp_{i,x_{i-1}}=min(dp_{i-1,j}+abs(x_i-j))$。展开绝对值分类讨论即可。</p><p>滚动<code>dp</code>数组然后，对于每个操作，$dp$ 数组先整体加上 $abs(x_i-x_{i-1})$。单独考虑 $dp_{i,x_{i-1}}$。这里对于 $j\le x_i$ 的取一个min,对于 $j\ge x_i$ 取一个min。显然两颗线段树优化。</p><p>草稿本上的式子抄错调了2h无果，不愧是我。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Tree1 Tree[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Tree2 Tree[1]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Tree3 Tree[2]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 100000000000000000LL</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> x, <span class="keyword">const</span> <span class="keyword">int</span> y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">abs</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> k)</span> </span>&#123;<span class="keyword">return</span> k &gt;= <span class="number">0</span> ? k : -k;&#125;</span><br><span class="line"><span class="keyword">int</span> x[<span class="number">200005</span>], tot;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Segment_tree</span> &#123;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">		<span class="keyword">int</span> l, r, v, Lazy;</span><br><span class="line">	&#125; c[<span class="number">1000005</span>];</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">make_tree</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O, <span class="keyword">const</span> <span class="keyword">int</span> L, <span class="keyword">const</span> <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">		c[O].l = L, c[O].r = R, c[O].v = INF;</span><br><span class="line">		<span class="keyword">if</span> (L != R) &#123;</span><br><span class="line">			<span class="built_in">make_tree</span>(O &lt;&lt; <span class="number">1</span>, L, L + R &gt;&gt; <span class="number">1</span>);</span><br><span class="line">			<span class="built_in">make_tree</span>(O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, (L + R &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>, R);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O)</span> </span>&#123;</span><br><span class="line">		c[O &lt;&lt; <span class="number">1</span>].v += c[O].Lazy, c[O &lt;&lt; <span class="number">1</span>].Lazy += c[O].Lazy;</span><br><span class="line">		c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].v += c[O].Lazy, c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].Lazy += c[O].Lazy;</span><br><span class="line">		c[O].Lazy = <span class="number">0LL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O, <span class="keyword">const</span> <span class="keyword">int</span> p, <span class="keyword">const</span> <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (c[O].l == c[O].r) &#123;c[O].v = <span class="built_in">min</span>(c[O].v, d); <span class="keyword">return</span>;&#125;</span><br><span class="line">		<span class="built_in">pushdown</span>(O);</span><br><span class="line">		<span class="function"><span class="keyword">const</span> <span class="keyword">int</span> <span class="title">mid</span><span class="params">(c[O].l + c[O].r &gt;&gt; <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="keyword">if</span> (p &lt;= mid) <span class="built_in">update</span>(O &lt;&lt; <span class="number">1</span>, p, d);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">update</span>(O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, p, d);</span><br><span class="line">		c[O].v = <span class="built_in">min</span>(c[O &lt;&lt; <span class="number">1</span>].v, c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].v);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O, <span class="keyword">const</span> <span class="keyword">int</span> L, <span class="keyword">const</span> <span class="keyword">int</span> R, <span class="keyword">const</span> <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (L &gt; R) <span class="keyword">return</span>;</span><br><span class="line">		<span class="keyword">if</span> (L &lt;= c[O].l &amp;&amp; c[O].r &lt;= R) &#123;c[O].v += d, c[O].Lazy += d; <span class="keyword">return</span>;&#125;</span><br><span class="line">		<span class="function"><span class="keyword">const</span> <span class="keyword">int</span> <span class="title">mid</span><span class="params">(c[O].l + c[O].r &gt;&gt; <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="built_in">pushdown</span>(O);</span><br><span class="line">		<span class="keyword">if</span> (L &lt;= mid) <span class="built_in">Add</span>(O &lt;&lt; <span class="number">1</span>, L, R, d);</span><br><span class="line">		<span class="keyword">if</span> (mid &lt; R) <span class="built_in">Add</span>(O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, L, R, d);</span><br><span class="line">		c[O].v = <span class="built_in">min</span>(c[O &lt;&lt; <span class="number">1</span>].v, c[O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].v);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> O, <span class="keyword">const</span> <span class="keyword">int</span> L, <span class="keyword">const</span> <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (L &gt; R) <span class="keyword">return</span> INF;</span><br><span class="line">		<span class="keyword">if</span> (L &lt;= c[O].l &amp;&amp; c[O].r &lt;= R) <span class="keyword">return</span> c[O].v;</span><br><span class="line">		<span class="function"><span class="keyword">const</span> <span class="keyword">int</span> <span class="title">mid</span><span class="params">(c[O].l + c[O].r &gt;&gt; <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="built_in">pushdown</span>(O);</span><br><span class="line">		<span class="function"><span class="keyword">int</span> <span class="title">ans</span><span class="params">(INF)</span></span>;</span><br><span class="line">		<span class="keyword">if</span> (L &lt;= mid) ans = <span class="built_in">min</span>(ans, <span class="built_in">query</span>(O &lt;&lt; <span class="number">1</span>, L, R));</span><br><span class="line">		<span class="keyword">if</span> (mid &lt; R) ans = <span class="built_in">min</span>(ans, <span class="built_in">query</span>(O &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, L, R));</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; Tree[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n, q, A, B;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld&quot;</span>, &amp;n, &amp;q, &amp;A, &amp;B);</span><br><span class="line">	Tree1.<span class="built_in">make_tree</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">	Tree2.<span class="built_in">make_tree</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">	Tree3.<span class="built_in">make_tree</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">	x[tot = <span class="number">1</span>] = A;</span><br><span class="line">	Tree1.<span class="built_in">update</span>(<span class="number">1</span>, B, -B);</span><br><span class="line">	Tree2.<span class="built_in">update</span>(<span class="number">1</span>, B, B);</span><br><span class="line">	Tree3.<span class="built_in">update</span>(<span class="number">1</span>, B, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">while</span> (q --) &#123;</span><br><span class="line">		++ tot; </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;x[tot]);</span><br><span class="line">		int ret(min(x[tot] + Tree1.query(1, 1, x[tot]), Tree2.query(1, x[tot], n) - x[tot])), add();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> <span class="built_in">i</span>(<span class="number">0</span>); i &lt;= <span class="number">2</span>; ++ i)</span><br><span class="line">			Tree[i].<span class="built_in">Add</span>(<span class="number">1</span>, <span class="number">1</span>, n, <span class="built_in">abs</span>(x[tot] - x[tot - <span class="number">1</span>]));</span><br><span class="line">		Tree1.<span class="built_in">update</span>(<span class="number">1</span>, x[tot - <span class="number">1</span>], ret - x[tot - <span class="number">1</span>]);</span><br><span class="line">		Tree2.<span class="built_in">update</span>(<span class="number">1</span>, x[tot - <span class="number">1</span>], ret + x[tot - <span class="number">1</span>]);</span><br><span class="line">		Tree3.<span class="built_in">update</span>(<span class="number">1</span>, x[tot - <span class="number">1</span>], ret);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, Tree3.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> zqs菜鸡</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="http://example.com/2021/03/06/3-5-solution/" title="3&#x2F;5练习赛题解">http://example.com/2021/03/06/3-5-solution/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E6%AF%94%E8%B5%9B/" rel="tag"><i class="fa fa-tag"></i> 比赛</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2021/02/27/nkoj-7906/" rel="prev" title="nkoj-7906题解"><i class="fa fa-chevron-left"></i> nkoj-7906题解</a></div><div class="post-nav-item"> <a href="/2021/03/07/luogu-P2048/" rel="next" title="洛谷P2048 【[NOI2010] 超级钢琴】题解">洛谷P2048 【[NOI2010] 超级钢琴】题解<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#A%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">A：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#B"><span class="nav-number">2.</span> <span class="nav-text">B:</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#C"><span class="nav-number">3.</span> <span class="nav-text">C:</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">zqs菜鸡</p><div class="site-description" itemprop="description">反正是个菜鸡</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">59</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">13</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">34</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/ioiakzqs" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ioiakzqs" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://gitee.com/zqs2020" title="Gitee → https:&#x2F;&#x2F;gitee.com&#x2F;zqs2020" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> Gitee</a></span><span class="links-of-author-item"><a href="https://blog.csdn.net/jvruo_shabi" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;jvruo_shabi" rel="noopener" target="_blank"><i class="fa fa-fw fa-book"></i> CSDN</a></span><span class="links-of-author-item"><a href="https://www.luogu.com.cn/user/361308" title="洛谷 → https:&#x2F;&#x2F;www.luogu.com.cn&#x2F;user&#x2F;361308" rel="noopener" target="_blank"><i class="fa fa-fw fa-code"></i> 洛谷</a></span></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div style=""><canvas id="canvas" style="width:60%">当前浏览器不支持canvas，请更换浏览器后再试</canvas></div><script>!function(){var t,o=[[[0,0,1,1,1,0,0],[0,1,1,0,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,0,1,1,0],[0,0,1,1,1,0,0]],[[0,0,0,1,1,0,0],[0,1,1,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[1,1,1,1,1,1,1]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,0,0,1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,0,1,1,1,0],[0,0,1,1,1,1,0],[0,1,1,0,1,1,0],[1,1,0,0,1,1,0],[1,1,1,1,1,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,1,1]],[[1,1,1,1,1,1,1],[1,1,0,0,0,0,0],[1,1,0,0,0,0,0],[1,1,1,1,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[1,1,1,1,1,1,1],[1,1,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,1,1,0,0,0,0]],[[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0]]],e=document.getElementById("canvas");if(e.getContext){var l=e.getContext("2d");e.height=100,e.width=700,l.fillStyle="#f00",l.fillRect(10,10,50,50);var r=[],f=[],i=e.height/20-1;function n(t,e){for(var n=0;n<o[e].length;n++)for(var a=0;a<o[e][n].length;a++)1==o[e][n][a]&&(l.beginPath(),l.arc(14*(i+2)*t+2*a*(i+1)+(i+1),2*n*(i+1)+(i+1),i,0,2*Math.PI),l.closePath(),l.fill())}function h(t,e){for(var n=[1,2,3],a=["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"],l=0;l<o[e].length;l++)for(var r=0;r<o[e][l].length;r++)if(1==o[e][l][r]){var h={x:14*(i+2)*t+2*r*(i+1)+(i+1),y:2*l*(i+1)+(i+1),stepX:Math.floor(4*Math.random()-2),stepY:-2*n[Math.floor(Math.random()*n.length)],color:a[Math.floor(Math.random()*a.length)],disY:1};f.push(h)}}t=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date),r.push(t[1],t[2],10,t[3],t[4],10,t[5],t[6]),clearInterval(a);var a=setInterval(function(){!function(){var t=[],e=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date),n=[];n.push(e[1],e[2],10,e[3],e[4],10,e[5],e[6]);for(var a=r.length-1;0<=a;a--)n[a]!==r[a]&&t.push(a+"_"+(Number(r[a])+1)%10);for(a=0;a<t.length;a++)h.apply(this,t[a].split("_"));r=n.concat()}(),function(){for(var t=0;t<f.length;t++)f[t].stepY+=f[t].disY,f[t].x+=f[t].stepX,f[t].y+=f[t].stepY,(f[t].x>700+i||f[t].y>100+i)&&(f.splice(t,1),t--)}(),function(){e.height=100;for(var t=0;t<r.length;t++)n(t,r[t]);for(t=0;t<f.length;t++)l.beginPath(),l.arc(f[t].x,f[t].y,i,0,2*Math.PI),l.fillStyle=f[t].color,l.closePath(),l.fill()}()},50)}}()</script></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2021</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">zqs菜鸡</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script size="300" alpha="0.6" zindex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script defer="defer" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js"></script><script defer="defer" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three-waves.min.js"></script><script src="/js/local-search.js"></script><script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script><script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script><script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'http://example.com/2021/03/06/3-5-solution/',]
      });
      });
  </script><script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'Ttn6wpyi3PGFvGaXy67O0CB7-gzGzoHsz',
      appKey     : 'hVx8JDoum8iYxMFoDaum95Ih',
      placeholder: "stO Orz",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script><script type="text/javascript" src="/js/fold_action.js"></script><script type="text/javascript" src="/js/love.js"></script></body></html>